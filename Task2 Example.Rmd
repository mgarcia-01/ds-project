---
title: "Task 2 Example"
author: "Michael Garcia"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r libimport}
library(dplyr)
library(tidytext)
library(ggplot2)
```


```{r readdata}
blogsfile = "./final/en_us/en_US.blogs.txt"
newsfile = "./final/en_us/en_US.news.txt"
twitfile = "./final/en_us/en_US.twitter.txt"


str_eng_news <- readLines(newsfile)
str_eng_blogs <- readLines(blogsfile)
str_eng_twitter <- readLines(twitfile)
```


```{r step1}
# convert each to tibble
df_eng_news <- tibble(line = 1:length(str_eng_news), text = str_eng_news)
df_eng_blogs <- tibble(line = 1:length(str_eng_blogs), text = str_eng_blogs)
df_eng_twitter <- tibble(line = 1:length(str_eng_twitter), text = str_eng_twitter)

# unnest tokens
df_eng_news_unnest <- df_eng_news %>% 
       unnest_tokens(word, text) %>% # makes lowercase
       mutate(source = "news")

df_eng_blogs_unnest <- df_eng_blogs %>% 
       unnest_tokens(word, text) %>% 
       mutate(source = "blogs")

df_eng_twitter_unnest <- df_eng_twitter %>% 
       unnest_tokens(word, text) %>% 
       mutate(source = "twitter")

# remove numbers since we're looking at words
df_eng_news_unnest <- df_eng_news_unnest %>% filter(!grepl("[0-9]", word))
df_eng_blogs_unnest <- df_eng_blogs_unnest %>% filter(!grepl("[0-9]", word))
df_eng_twitter_unnest <- df_eng_twitter_unnest %>% filter(!grepl("[0-9]", word))

# combine into one
df_eng <- rbind(df_eng_news_unnest, df_eng_blogs_unnest, df_eng_twitter_unnest)

# remove stop words
df_eng <- df_eng %>% anti_join(stop_words, by = "word")
```

## Determine most common single words across all sources

```{r commonwords, echo=FALSE}
# distribution of words
df_eng_wordcount <- df_eng %>% count(word, sort = TRUE)     

df_eng_wordcount %>% head(n = 20) %>% mutate(word = reorder(word, n)) %>% 
       
       ggplot(aes(x = n, y = word)) +
       geom_col(fill = "#00abff") +
       theme_bw() +
       ggtitle("Most frequently used words in the English language")
```

